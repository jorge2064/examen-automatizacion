name: Deployment Pipeline

on:
  workflow_dispatch:

jobs:
 deploy:
     runs-on: ubuntu-latest

     steps:
       #1. Descargar el codigo repo
       - name: Checkout repo
         uses: actions/checkout@v3

       #2. Construir el proyecto con Maven
       - name: Build app
         run: mvn clean package -DskipTests

       #3. Pruebas de aceptacion (simuladas por ahora)
       - name: Acceptance tests
         run: echo "Acceptance tests ejecutadas con exito"

       #4. Despliegue en ambiente de pruebas (simulacion)
       - name: Deploy to staging
         run: echo "Desplegando aplicacion en ambiente de pruebas"

       #5. Estrategia de despliegue Canary / Blue-Green
       - name: Canary/ Blue-Green release
         run: echo "Activando estrategia Canary / Blue-Green..."

       #6. Rollback (solo si falla algo antes)
       - name: Rollback simulation
         if: failure()
         run: echo "Rollback ejecutado:se revirtio a una version mas estable "